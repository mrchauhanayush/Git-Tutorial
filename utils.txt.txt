This is a utility function version 2.